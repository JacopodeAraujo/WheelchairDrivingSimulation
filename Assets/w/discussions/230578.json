[
  {
    "Id": "506017",
    "ThreadId": "230578",
    "Html": "<p>Windows Input Simulator is an awesome solution to my virtual keyboard for WPF applications!</p>\r\n<p>But I have noticed that <a href=\"http://alt-codes.org/list/\">Alt Codes</a> do not work with it.</p>\r\n<p>So I have used my previous solution and now I am posting it here.</p>\r\n<p>Hopefully, the author will add this to the sources.</p>\r\n<p>&nbsp;</p>\r\n<p>First, within the NativeMethods.cs I declare the following:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>[System.Runtime.InteropServices.DllImport(<span style=\"color:#a31515\">&quot;user32.dll&quot;</span>)]\r\n<span style=\"color:blue\">internal</span> <span style=\"color:blue\">static</span> <span style=\"color:blue\">extern</span> <span style=\"color:blue\">uint</span> MapVirtualKey(<span style=\"color:blue\">uint</span> uCode, <span style=\"color:blue\">uint</span> uMapType);\r\n\r\n<span style=\"color:blue\">internal</span> <span style=\"color:blue\">enum</span> MAPVK\r\n{\r\nMAPVK_VK_TO_VSC = 0x0,\r\nMAPVK_VSC_TO_VK = 0x1,\r\nMAPVK_VK_TO_CHAR = 0x2,\r\nMAPVK_VSC_TO_VK_EX = 0x3,\r\n}</pre>\r\n</div>\r\n<p>Then, within the InputBuilder.cs I add the following lines to the AddKeyDown method:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">uint</span> VirtualScanCode = Native.NativeMethods.MapVirtualKey((<span style=\"color:blue\">uint</span>)(keyCode), (<span style=\"color:blue\">uint</span>)(Native.NativeMethods.MAPVK.MAPVK_VK_TO_VSC));\r\ndown.Data.Keyboard.Scan = (<span style=\"color:blue\">ushort</span>)(VirtualScanCode);</pre>\r\n</div>\r\n<p>Then, within the InputBuilder.cs I add the following lines to the AddKeyUp method:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">uint</span> VirtualScanCode = Native.NativeMethods.MapVirtualKey((<span style=\"color:blue\">uint</span>)(keyCode), (<span style=\"color:blue\">uint</span>)(Native.NativeMethods.MAPVK.MAPVK_VK_TO_VSC));\r\nup.Data.Keyboard.Scan = (<span style=\"color:blue\">ushort</span>)(VirtualScanCode);\r\n</pre>\r\n</div>\r\n<p>And then Alt Codes begin to report correctly.</p>",
    "PostedDate": "2010-10-12T06:49:07.633-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]