[
  {
    "Id": "713418",
    "ThreadId": "283264",
    "Html": "\r\n<p>Hello,</p>\r\n<p>I have an external application that is hooking into the Windows keyboard input stream.</p>\r\n<p>I want to be able to send message into this stream. Can I do this with input simulator? Currently, the input is going to whatever the foreground window is ?</p>\r\n<p>Thanks.</p>\r\n",
    "PostedDate": "2011-12-16T14:33:45.743-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "713957",
    "ThreadId": "283264",
    "Html": "Hi There,\r\n<div><br>\r\n</div>\r\n<div>The InputSimulator is just a lightweight .NET friendly wrapper for the win32 SendInput API which targets the currently active window. Best thing I can recommend is diving into the MSDN documentation and experimenting yourself.</div>\r\n<div><br>\r\n</div>\r\n<div>Good luck,</div>\r\n<div>Mike<br>\r\n<br>\r\n<div>On Sat, Dec 17, 2011 at 8:33 AM, nitinsobti <span dir=\"ltr\">&lt;<a href=\"mailto:notifications@codeplex.com\">notifications@codeplex.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\n<div>\r\n<p>From: nitinsobti</p>\r\n<div>\r\n<p>Hello,</p>\r\n<p>I have an external application that is hooking into the Windows keyboard input stream.</p>\r\n<p>I want to be able to send message into this stream. Can I do this with input simulator? Currently, the input is going to whatever the foreground window is ?</p>\r\n<p>Thanks.</p>\r\n</div>\r\n<div>\r\n<p>Read the <a href=\"http://inputsimulator.codeplex.com/discussions/283264#post713418\" target=\"_blank\">\r\nfull discussion online</a>.</p>\r\n<p>To add a post to this discussion, reply to this email (<a href=\"mailto:inputsimulator@discussions.codeplex.com?subject=[inputsimulator:283264]\" target=\"_blank\">inputsimulator@discussions.codeplex.com</a>)</p>\r\n<p>To start a new discussion for this project, email <a href=\"mailto:inputsimulator@discussions.codeplex.com\" target=\"_blank\">\r\ninputsimulator@discussions.codeplex.com</a></p>\r\n<p>You are receiving this email because you subscribed to this discussion on CodePlex. You can\r\n<a href=\"https://inputsimulator.codeplex.com/subscriptions/thread/project/edit\" target=\"_blank\">\r\nunsubscribe or change your settings</a> on codePlex.com.</p>\r\n<p>Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at\r\n<a href=\"http://codeplex.com\" target=\"_blank\">codeplex.com</a></p>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n",
    "PostedDate": "2011-12-18T14:33:33.513-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "730511",
    "ThreadId": "283264",
    "Html": "<blockquote style=\"padding-bottom: 0px; font-style: italic; margin: 0.25em 1em 0px; padding-left: 0.25em; padding-right: 0.25em; padding-top: 0px; border: #ccc 0.1em solid;\"><strong>nitinsobti wrote:</strong><br />\r\n<p>Hello,</p>\r\n<p>I have an external application that is hooking into the Windows keyboard input stream.</p>\r\n<p>I want to be able to send message into this stream. Can I do this with input simulator? Currently, the input is going to whatever the foreground window is ?</p>\r\n<p>Thanks.</p>\r\n</blockquote>\r\n<p><br />Sorry for the late reply, but hopefully this will help someone with similar problems, even if only in theory and design. I had the same problem with&nbsp;keypresses always going to my own app instead of the app I wanted to reach. What I did was add each keypress to a queue (hidden combobox, but could probably use list or array) and use the appactivate (function?) to grab the app window I wanted before each keypress. This way if they interrupted application with multiple clicks it would wait until it had focus again before pressing another key (focus pass/fail). The only real caveat is if they were to perhaps rapid fire click and catch it between window grab and keypress. I've only done half a million lines or so of code and totally self-taught so my methods may be wrong and sloppy but they work!</p>\r\n<p>Forgive me using vb, but here is a sample&nbsp; :)</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> StartKeyPressTimer()\r\n        KeyPressQueueTimer = <span style=\"color: blue;\">New</span> DispatcherTimer\r\n        KeyPressQueueTimer.Interval = <span style=\"color: blue;\">New</span> TimeSpan(0, 0, 0, 0, 100)\r\n        <span style=\"color: blue;\">AddHandler</span> KeyPressQueueTimer.Tick, <span style=\"color: blue;\">AddressOf</span> PerformKeyPressTickMe\r\n        KeyPressQueueTimer.Start()\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> PerformKeyPressTickMe()\r\n        <span style=\"color: green;\">'Do whatever here  </span>\r\n\r\n        <span style=\"color: blue;\">If</span> ComboBoxKeyPressQueue.Items.<span style=\"color: blue;\">Count</span> = 0 <span style=\"color: blue;\">Then</span>\r\n            KeyPressQueueTimer.<span style=\"color: blue;\">Stop</span>()\r\n            <span style=\"color: green;\">'TODO: 1</span>\r\n            <span style=\"color: green;\">'Timer stops when there are no keypresses left in the queue and the combobox is empty</span>\r\n        <span style=\"color: blue;\">Else</span>\r\n            <span style=\"color: green;\">'The macro keypress combobox has an entry (or entries)...</span>\r\n            <span style=\"color: green;\">'Now gotta start the steps to check and see if iracing is...</span>\r\n            <span style=\"color: green;\">'A. running and..</span>\r\n            <span style=\"color: green;\">'B. Has focus before making a keypress</span>\r\n            IsProcessRunning(<span style=\"color: #a31515;\">\"iracingsim.exe\"</span>)\r\n\r\n            ComboBoxKeyPressQueue.Items.RemoveAt(0)\r\n            KeyPressQueueTimer.<span style=\"color: blue;\">Stop</span>()\r\n            <span style=\"color: blue;\">If</span> ComboBoxKeyPressQueue.Items.<span style=\"color: blue;\">Count</span> = 0 <span style=\"color: blue;\">Then</span>\r\n                <span style=\"color: green;\">'nothing </span>\r\n            <span style=\"color: blue;\">Else</span>\r\n                ComboBoxKeyPressQueue.SelectedIndex = 0\r\n            <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n        StartKeyPressTimer()\r\n\r\n\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Structure</span> ProcessData\r\n        <span style=\"color: blue;\">Dim</span> Caption <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">String</span>\r\n        <span style=\"color: green;\">' Dim CommandLine As String</span>\r\n        <span style=\"color: green;\">' Dim Owner As String</span>\r\n        <span style=\"color: green;\">' Dim Priority As String</span>\r\n        <span style=\"color: green;\">'Dim ProcessId As String</span>\r\n        <span style=\"color: green;\">' Dim ThreadCount As String</span>\r\n        <span style=\"color: green;\">' Dim HandleCount As String</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Structure</span>\r\n    <span style=\"color: blue;\">Public</span> <span style=\"color: blue;\">Function</span> IsProcessRunning(<span style=\"color: blue;\">ByVal</span> _processName <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">String</span>) <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">Boolean</span>\r\n        <span style=\"color: blue;\">Try</span>\r\n            <span style=\"color: blue;\">Dim</span> Win32_ProcessProperties() <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">String</span> = {<span style=\"color: #a31515;\">\"Caption\"</span>}\r\n            <span style=\"color: blue;\">Dim</span> propertyIndex <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">Integer</span> = 0\r\n            <span style=\"color: blue;\">For</span> <span style=\"color: blue;\">Each</span> obj <span style=\"color: blue;\">As</span> ManagementObject <span style=\"color: blue;\">In</span> wmi.GetInstances()\r\n                <span style=\"color: blue;\">ReDim</span> <span style=\"color: blue;\">Preserve</span> processList(processCount)\r\n                propertyIndex = 0\r\n                <span style=\"color: green;\">' Caption property.       </span>\r\n                <span style=\"color: blue;\">If</span> obj(Win32_ProcessProperties(propertyIndex)) <span style=\"color: blue;\">IsNot</span> <span style=\"color: blue;\">Nothing</span> <span style=\"color: blue;\">Then</span>\r\n                    processList(processCount).Caption = obj(Win32_ProcessProperties(propertyIndex)).ToString\r\n                    <span style=\"color: blue;\">If</span> LCase(_processName) = LCase(obj(Win32_ProcessProperties(propertyIndex)).ToString) <span style=\"color: blue;\">Then</span>\r\n                        <span style=\"color: green;\">'Ok, so iracing is running, now see if it's the active app</span>\r\n                        <span style=\"color: green;\">'MsgBox(\"iracing is running\")</span>\r\n                        CheckIfiRacingIsActiveApp()\r\n\r\n                        <span style=\"color: green;\">'dunno if the return is needed or will break the process chain</span>\r\n                        <span style=\"color: green;\">' Return True</span>\r\n                    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n                <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n                processCount += 1\r\n            <span style=\"color: blue;\">Next</span>\r\n            <span style=\"color: green;\">'  MsgBox(\"error. iracing not running\")</span>\r\n            <span style=\"color: blue;\">Return</span> <span style=\"color: blue;\">False</span>\r\n\r\n        <span style=\"color: blue;\">Catch</span> ex <span style=\"color: blue;\">As</span> Exception\r\n            <span style=\"color: blue;\">Return</span> <span style=\"color: blue;\">False</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Try</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Function</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> CheckIfiRacingIsActiveApp()\r\n        <span style=\"color: green;\">' Get current Active Window handle</span>\r\n        <span style=\"color: blue;\">Dim</span> hdl <span style=\"color: blue;\">As</span> IntPtr = GetForegroundWindow()\r\n        <span style=\"color: green;\">' Create Buffer for Active Window title</span>\r\n        <span style=\"color: blue;\">Dim</span> windowTitle <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">String</span> = Space(GetWindowTextLength(hdl) + 1)\r\n        <span style=\"color: green;\">' Get Active Window title, that is strTitle</span>\r\n        GetWindowText(hdl, windowTitle, windowTitle.Length)\r\n        <span style=\"color: green;\">' Write (appended) Active Window title to 1.txt file for verification</span>\r\n        <span style=\"color: green;\">' My.Computer.FileSystem.WriteAllText(\"C:\\1.txt\", windowTitle, True)</span>\r\n\r\n        <span style=\"color: blue;\">If</span> windowTitle.Contains(<span style=\"color: #a31515;\">\"iRacing.com Simulator\"</span>) <span style=\"color: blue;\">Then</span>\r\n            <span style=\"color: green;\">' MsgBox(\"iracing is the active app\")</span>\r\n            PerformKeyPress()\r\n        <span style=\"color: blue;\">Else</span>\r\n            <span style=\"color: green;\">'Activate the app before starting the macro</span>\r\n            ActivateAppiRacing()\r\n            <span style=\"color: green;\">' MsgBox(\"iracing is NOT the active app\")</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> ActivateAppiRacing()\r\n        <span style=\"color: blue;\">Try</span>\r\n\r\n            <span style=\"color: green;\">'Activates the app by bringing it into focus (by Description)</span>\r\n            AppActivate(<span style=\"color: #a31515;\">\"iracing.com simulator\"</span>)\r\n            PerformKeyPress()\r\n\r\n        <span style=\"color: blue;\">Catch</span> ex <span style=\"color: blue;\">As</span> Exception\r\n\r\n            <span style=\"color: green;\">'This should only trip if program crashes or shuts down in between the time it checked to see if it was running and if it was the active app</span>\r\n            <span style=\"color: green;\">' MsgBox(\"error. external program not running\")</span>\r\n\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Try</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n</pre>\r\n</div>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> PerformMacro()\r\n        <span style=\"color: green;\">'App should be activated (has focus), so every single action here must re-confirm app is running and active before committing</span>\r\n        <span style=\"color: green;\">'MIGHT need some timing adjustment on the timer intervals to make it fast enough to seem seamless.</span>\r\n\r\n        ComboBoxMacroQueue.SelectedIndex = 0\r\n\r\n        <span style=\"color: blue;\">If</span> ComboBoxMacroQueue.Text = <span style=\"color: #a31515;\">\"Toggle LF Tire\"</span> <span style=\"color: blue;\">Then</span>\r\n\r\n            <span style=\"color: blue;\">If</span> ChangeLFTire = <span style=\"color: blue;\">False</span> <span style=\"color: blue;\">Then</span>\r\n                <span style=\"color: green;\">'Selecting LF tire to change</span>\r\n                <span style=\"color: green;\">'need to get actual macro sequence of keypresses</span>\r\n                ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"BEGINNING OF MACRO\"</span>)\r\n                <span style=\"color: blue;\">If</span> F5TireHighlightLF = <span style=\"color: blue;\">True</span> <span style=\"color: blue;\">Then</span>\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"KeyboardPressF5\"</span>)\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"SPACE\"</span>)\r\n                <span style=\"color: blue;\">ElseIf</span> F5TireHighlightLR = <span style=\"color: blue;\">True</span> <span style=\"color: blue;\">Then</span>\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"KeyboardPressF5\"</span>)\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"PREV\"</span>)\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"SPACE\"</span>)\r\n                <span style=\"color: blue;\">ElseIf</span> F5TireHighlightRF = <span style=\"color: blue;\">True</span> <span style=\"color: blue;\">Then</span>\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"KeyboardPressF5\"</span>)\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"PREV\"</span>)\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"PREV\"</span>)\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"SPACE\"</span>)\r\n                <span style=\"color: blue;\">ElseIf</span> F5TireHighlightRR = <span style=\"color: blue;\">True</span> <span style=\"color: blue;\">Then</span>\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"KeyboardPressF5\"</span>)\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"PREV\"</span>)\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"PREV\"</span>)\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"PREV\"</span>)\r\n                    ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"SPACE\"</span>)\r\n\r\n                <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n                F5TireHighlightLF = <span style=\"color: blue;\">True</span>\r\n                F5TireHighlightRF = <span style=\"color: blue;\">False</span>\r\n                F5TireHighlightLR = <span style=\"color: blue;\">False</span>\r\n                F5TireHighlightRR = <span style=\"color: blue;\">False</span>\r\n                ComboBoxKeyPressQueue.Items.Add(<span style=\"color: #a31515;\">\"END OF MACRO\"</span>)\r\n                <span style=\"color: green;\">'macro complete</span>\r\n<span style=\"color: blue;\">end</span> <span style=\"color: blue;\">sub</span>\r\n</pre>\r\n<pre><div style=\"color: black; background-color: white;\"><pre><span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> PerformKeyPress()\r\n\r\n        <span style=\"color: green;\">'  MsgBox(ComboBoxKeyPressQueue.Items.Count)</span>\r\n        <span style=\"color: green;\">'Read the selected item and perform its keypress</span>\r\n        ComboBoxKeyPressQueue.SelectedIndex = 0\r\n\r\n        <span style=\"color: blue;\">If</span> ComboBoxKeyPressQueue.Text = <span style=\"color: #a31515;\">\"BEGINNING OF MACRO\"</span> <span style=\"color: blue;\">Then</span>\r\n            <span style=\"color: green;\">'This will either turn on or off a non-adjustment f key so that when we have to press an actual f key</span>\r\n            <span style=\"color: green;\">'we won't turn it off by mistake</span>\r\n            PressBenignFKey()\r\n\r\n            <span style=\"color: green;\">'ALL KEYPRESSES HERE</span>\r\n        <span style=\"color: blue;\">ElseIf</span> ComboBoxKeyPressQueue.Text = <span style=\"color: #a31515;\">\"KeyboardPressF1\"</span> <span style=\"color: blue;\">Then</span>\r\n            System.Threading.Thread.Sleep(500)\r\n            InputSimulator.SimulateKeyPress(VirtualKeyCode.F1)\r\n        <span style=\"color: blue;\">ElseIf</span> ComboBoxKeyPressQueue.Text = <span style=\"color: #a31515;\">\"KeyboardPressF2\"</span> <span style=\"color: blue;\">Then</span>\r\n            System.Threading.Thread.Sleep(500)\r\n            InputSimulator.SimulateKeyPress(VirtualKeyCode.F2)...\r\n</pre>\r\n</div>\r\n</pre>\r\n<pre>Good luck!</pre>\r\n<pre>Mark</pre>\r\n<pre><a href=\"http://www.teammpr.org/\">www.teammpr.org</a></pre>\r\n</div>",
    "PostedDate": "2012-01-25T07:09:49.38-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]